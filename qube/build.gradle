plugins {
    id "nebula.kotlin" version "1.1.4"
    id "io.quartic.service" version "53"
    id "com.palantir.configuration-resolver" version "0.2.0"
}

service {
    mainClassName = "io.quartic.qube.QubeApplication"
    memory = System.env.QUBE_MEMORY ?: "32m"
}

repositories {
    jcenter()   // For coroutines
}

dependencies {
    compile project(":common-application")
    compile project(":qube-api")
    compile project(":registry-api")
    compile project(":github")
    compile project(":quarty")

    compile "io.fabric8:kubernetes-client:2.6.1"
    compile "org.flywaydb:flyway-core:4.2.0"
    compile libraries.dropwizardJdbi
    compile "org.jdbi:jdbi3-kotlin:3.0.0-beta2"
    compile "org.jdbi:jdbi3-kotlin-sqlobject:3.0.0-beta2"
    compile "org.jdbi:jdbi3-postgres:3.0.0-beta2"
    compile libraries.rxjava
    compile "com.opentable.components:otj-pg-embedded:0.9.0"

    compile "org.jetbrains.kotlinx:kotlinx-coroutines-core:0.17"
    compile "org.jetbrains.kotlinx:kotlinx-coroutines-jdk8:0.17"

    compile "io.vertx:vertx-web:3.4.2"

    runtime "ch.qos.logback:logback-classic:1.2.3"

    testCompile project(":common-test")
    testCompile "io.dropwizard:dropwizard-testing:${versions.dropwizard}"
}

kotlin {
    experimental {
        coroutines "enable"
    }
}
