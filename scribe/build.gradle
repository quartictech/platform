import io.quartic.gradle.kotlin.KotlinPlugin
import io.quartic.gradle.service.ServicePlugin

plugins {
    id "com.palantir.configuration-resolver" version "0.2.0"
}

apply plugin: KotlinPlugin
apply plugin: ServicePlugin

service {
    mainClassName = "io.quartic.tracker.scribe.ScribeApplication"
    memory = System.env.SCRIBE_MEMORY ?: "64m"
    // We need to override this due to an apparent bug with netty in alpine
    // see: https://github.com/GoogleCloudPlatform/google-cloud-java/issues/1430
    dockerBaseImage = "openjdk:8u141-jre"
}

dependencies {
    compile project(":common-application")
    compile project(":catalogue-utils")

    compile("com.google.cloud:google-cloud-pubsub:0.8.0") {
        exclude group: "javax.servlet", module: "servlet-api"   // Conflicts with Dropwizard ecosystem
    }
    compile("com.google.cloud:google-cloud-storage:0.8.0-beta") {
        exclude group: "javax.servlet", module: "servlet-api"   // Conflicts with Dropwizard ecosystem
    }

    testCompile project(":common-test")
}
